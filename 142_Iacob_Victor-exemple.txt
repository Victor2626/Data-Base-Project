12

--1
WITH SpecieAnimale AS (
  SELECT ID_SPECIE
  FROM SPECIE
  WHERE RASA = 'Leu African'
),
IngrijitoriSpecie AS (
  SELECT a.NUME, a.PRENUME
  FROM ANGAJAT a
  JOIN INGRIJIRE i ON a.ID_ANGAJAT = i.ID_ANGAJAT
  JOIN ANIMAL an ON i.ID_ANIMAL = an.ID_ANIMAL
  JOIN SpecieAnimale sa ON an.ID_SPECIE = sa.ID_SPECIE
)
SELECT *
FROM IngrijitoriSpecie;

--2
SELECT G.ID_GRADINA_ZOO,
       G.ORAS,
       A.NUME || ' ' || A.PRENUME AS NUME_ANGAJAT,
       TO_CHAR(P.ORA_DESCHIDERII) AS ORA_DESCHIDERII,
       TO_CHAR(P.ORA_INCHIDERII) AS ORA_INCHIDERII,
       CASE
           WHEN G.MARIME > 3000 THEN 'Mare'
           WHEN G.MARIME > 2000 THEN 'Medie'
           ELSE 'Mica'
       END AS DIMENSIUNE_GRADINA
FROM GRADINA_ZOO G
JOIN ANGAJAT A ON G.ID_ANGAJAT = A.ID_ANGAJAT
JOIN PROGRAM P ON G.ID_PROGRAM = P.ID_PROGRAM
WHERE UPPER(G.ORAS) = 'BUCURESTI'
  AND G.ID_GRADINA_ZOO NOT IN (
      SELECT ID_GRADINA_ZOO
      FROM GRADINA_ZOO
      WHERE UPPER(ORAS) = 'CLUJ-NAPOCA'
  );

--3
SELECT NVL(DECODE(GZ.MARIME, 5000, 'Foarte mare',
                              3000, 'Mare',
                              2000, 'Medie',
                              1000, 'Mica',
                              'Necunoscut'), 'Necunoscut') AS MARIME_GRADINA
FROM (SELECT DISTINCT MARIME
      FROM GRADINA_ZOO) GZ;

--4
SELECT G.ORAS, A.GEN, S.CATEGORIE_BILET, COUNT(*) AS NUMAR_ANIMALE
FROM GRADINA_ZOO G
JOIN ANGAJAT A ON G.ID_ANGAJAT = A.ID_ANGAJAT
JOIN LEGATURA L ON G.ID_ANIMAL = L.ID_ANIMAL
JOIN SPECTACOL SP ON L.ID_SPECTACOL = SP.ID_SPECTACOL
JOIN BILET S ON SP.ID_BILET = S.ID_BILET
GROUP BY G.ORAS, A.GEN, S.CATEGORIE_BILET
HAVING COUNT(*) > 0;

--5

SELECT a.NUME, a.PRENUME, c.ID_CUSCA, c.MATERIAL, l.POZITIE
FROM ANGAJAT a
JOIN INGRIJIRE i ON a.ID_ANGAJAT = i.ID_ANGAJAT
JOIN CUSCA c ON i.ID_CUSCA = c.ID_CUSCA
JOIN LOCATIE l ON c.ID_LOCATIE = l.ID_LOCATIE
WHERE c.MATERIAL = 'Metal' AND l.POZITIE = 'Sector A';



13

UPDATE GRADINA_ZOO
SET ORAS = 'Pitesti', MARIME = 6000
WHERE ID_GRADINA_ZOO = 20;

UPDATE ANGAJAT
SET NUME = 'Dan', PRENUME = 'Cristi', VARSTA = 53, GEN = 'M', SALARIU = 123000
WHERE ID_ANGAJAT = 2;

UPDATE ANIMAL
SET CATEGORIE = 'Reptila', NR_ANIMALE = 35, NUME_ANIMAL = 'Sarpe', ID_SPECIE = 3
WHERE ID_ANIMAL = 3;

